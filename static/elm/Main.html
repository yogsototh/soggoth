<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>Main</title><script type="text/javascript" src="/static/js/elm-runtime.js"></script><script type="text/javascript">Elm.Main = Elm.Main || {};
Elm.Main.make = function (_elm) {
   "use strict";
   _elm.Main = _elm.Main || {};
   if (_elm.Main.values)
   return _elm.Main.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _A = _N.Array.make(_elm),
   _E = _N.Error.make(_elm),
   $moduleName = "Main";
   var Array = Elm.Array.make(_elm);
   var Basics = Elm.Basics.make(_elm);
   var Cat = Elm.Cat.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Dict = Elm.Dict.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var Http = Elm.Http.make(_elm);
   var Json = Elm.Json.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Json = Elm.Native.Json.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var Window = Elm.Window.make(_elm);
   var _op = {};
   var jsonGetRequest = function (url) {
      return A4(Http.request,
      "GET",
      url,
      "",
      _L.fromArray([{ctor: "_Tuple2"
                    ,_0: "Accept"
                    ,_1: "application/json"}]));
   };
   var getJson = function (url) {
      return Http.send(Signal.constant(jsonGetRequest(url)));
   };
   var listToGrid = F2(function (n,
   l) {
      return function () {
         switch (l.ctor)
         {case "[]":
            return _L.fromArray([]);}
         return {ctor: "::"
                ,_0: A2(List.take,n,l)
                ,_1: A2(listToGrid,
                n,
                A2(List.drop,n,l))};
      }();
   });
   var elapsedTime = A3(Signal.foldp,
   F2(function (x,y) {
      return x + y;
   }),
   0,
   Time.fps(30));
   var gonSize = 150;
   var rotationSpeed = 1 / 5000;
   var showOneCat = F2(function (t,
   _v1) {
      return function () {
         switch (_v1.ctor)
         {case "Cat":
            return function () {
                 var ccolor = function () {
                    var _v4 = _v1._0.age;
                    switch (_v4.ctor)
                    {case "Just": switch (_v4._0)
                         {case 0: return A4(Color.rgba,
                              255,
                              220,
                              220,
                              1.0);
                            case 1: return Color.red;
                            case 2: return Color.orange;
                            case 3: return Color.yellow;
                            case 4: return Color.green;
                            case 5: return Color.blue;}
                         return function () {
                            var level = A2(Basics.div,
                            255,
                            _v4._0);
                            return A4(Color.rgba,
                            level,
                            level,
                            level,
                            1.0);
                         }();
                       case "Nothing":
                       return Color.grey;}
                    _E.Case($moduleName,
                    "between lines 50 and 60");
                 }();
                 var shape = function () {
                    var _v6 = _v1._0.age;
                    switch (_v6.ctor)
                    {case "Just": switch (_v6._0)
                         {case 0:
                            return A2(Graphics.Collage.oval,
                              gonSize - 20,
                              gonSize);
                            case 1:
                            return A2(Graphics.Collage.oval,
                              gonSize - 20,
                              gonSize);
                            case 2:
                            return A2(Graphics.Collage.rect,
                              gonSize / 2,
                              gonSize);}
                         return A2(Graphics.Collage.ngon,
                         _v6._0,
                         gonSize / 2);
                       case "Nothing":
                       return A2(Graphics.Collage.oval,
                         gonSize - 10,
                         gonSize - 20);}
                    _E.Case($moduleName,
                    "between lines 44 and 50");
                 }();
                 return Graphics.Element.layers(_L.fromArray([A3(Graphics.Collage.collage,
                                                             Basics.round(gonSize),
                                                             Basics.round(gonSize),
                                                             _L.fromArray([Graphics.Collage.rotate(t * rotationSpeed)(A2(Graphics.Collage.move,
                                                             {ctor: "_Tuple2"
                                                             ,_0: 0
                                                             ,_1: 0},
                                                             A2(Graphics.Collage.filled,
                                                             ccolor,
                                                             shape)))]))
                                                             ,A4(Graphics.Element.container,
                                                             Basics.round(gonSize),
                                                             Basics.round(gonSize),
                                                             Graphics.Element.middle,
                                                             Text.centered(A2(Text.color,
                                                             A4(Color.rgba,
                                                             0,
                                                             0,
                                                             0,
                                                             0.6),
                                                             Text.bold(Text.toText(_v1._0.name)))))]));
              }();}
         _E.Case($moduleName,
         "between lines 44 and 63");
      }();
   });
   var showCats = F3(function (_v8,
   t,
   cats) {
      return function () {
         switch (_v8.ctor)
         {case "_Tuple2":
            return function () {
                 var nbOnRow = A2(Basics.div,
                 _v8._0,
                 200);
                 var containerSize = 200;
                 return function () {
                    switch (cats.ctor)
                    {case "Just":
                       switch (cats._0.ctor)
                         {case "Cats":
                            return function () {
                                 var drawOneLine = function (oneLine) {
                                    return Graphics.Element.flow(Graphics.Element.right)(A2(List.map,
                                    function ($) {
                                       return A3(Graphics.Element.container,
                                       containerSize,
                                       containerSize,
                                       Graphics.Element.middle)(showOneCat(t)($));
                                    },
                                    oneLine));
                                 };
                                 return A3(Graphics.Element.container,
                                 _v8._0,
                                 _v8._1,
                                 Graphics.Element.midTop)(Graphics.Element.flow(Graphics.Element.down)(A2(List.map,
                                 drawOneLine,
                                 A2(listToGrid,
                                 nbOnRow,
                                 function (_) {
                                    return _.cats;
                                 }(cats._0._0)))));
                              }();}
                         break;}
                    return A3(Graphics.Collage.collage,
                    _v8._0,
                    _v8._1,
                    _L.fromArray([A2(Graphics.Collage.rotate,
                    t * rotationSpeed,
                    A2(Graphics.Collage.filled,
                    Color.red,
                    A2(Graphics.Collage.ngon,
                    4,
                    50)))]));
                 }();
              }();}
         _E.Case($moduleName,
         "between lines 26 and 34");
      }();
   });
   var display = F3(function (_v15,
   t,
   response) {
      return function () {
         switch (_v15.ctor)
         {case "_Tuple2":
            return function () {
                 switch (response.ctor)
                 {case "Failure":
                    return Text.asText(response);
                    case "Success":
                    return A2(showCats,
                      {ctor: "_Tuple2"
                      ,_0: _v15._0
                      ,_1: _v15._1},
                      t)(Cat.jsonToCats(Json.fromString(response._0)));
                    case "Waiting":
                    return Text.asText("WAITING...");}
                 _E.Case($moduleName,
                 "between lines 20 and 23");
              }();}
         _E.Case($moduleName,
         "between lines 20 and 23");
      }();
   });
   var main = A2(Signal._op["~"],
   A2(Signal._op["~"],
   A2(Signal._op["<~"],
   display,
   Window.dimensions),
   elapsedTime),
   getJson("/cats"));
   _elm.Main.values = {_op: _op
                      ,rotationSpeed: rotationSpeed
                      ,gonSize: gonSize
                      ,elapsedTime: elapsedTime
                      ,main: main
                      ,display: display
                      ,showCats: showCats
                      ,listToGrid: listToGrid
                      ,showOneCat: showOneCat
                      ,jsonGetRequest: jsonGetRequest
                      ,getJson: getJson};
   return _elm.Main.values;
};Elm.Cat = Elm.Cat || {};
Elm.Cat.make = function (_elm) {
   "use strict";
   _elm.Cat = _elm.Cat || {};
   if (_elm.Cat.values)
   return _elm.Cat.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _A = _N.Array.make(_elm),
   _E = _N.Error.make(_elm),
   $moduleName = "Cat";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Dict = Elm.Dict.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var Json = Elm.Json.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Json = Elm.Native.Json.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var _op = {};
   var fromJust = function (_v0) {
      return function () {
         switch (_v0.ctor)
         {case "Just": return _v0._0;}
         _E.Case($moduleName,
         "on line 22, column 21 to 22");
      }();
   };
   var Cat = function (a) {
      return {ctor: "Cat",_0: a};
   };
   var catFromDict = function (val) {
      return function () {
         switch (val.ctor)
         {case "Object":
            return function () {
                 var _v5 = A2(Dict.get,
                 "name",
                 val._0);
                 switch (_v5.ctor)
                 {case "Just":
                    switch (_v5._0.ctor)
                      {case "String":
                         return function () {
                              var _v8 = A2(Dict.get,
                              "age",
                              val._0);
                              switch (_v8.ctor)
                              {case "Just":
                                 switch (_v8._0.ctor)
                                   {case "Null":
                                      return Maybe.Just(Cat({_: {}
                                                            ,age: Maybe.Nothing
                                                            ,name: _v5._0._0}));
                                      case "Number":
                                      return Maybe.Just(Cat({_: {}
                                                            ,age: Maybe.Just(Basics.round(_v8._0._0))
                                                            ,name: _v5._0._0}));}
                                   break;}
                              return Maybe.Nothing;
                           }();}
                      break;}
                 return Maybe.Nothing;
              }();}
         return Maybe.Nothing;
      }();
   };
   var objlistToCatList = function (dictList) {
      return function () {
         var jlist = A2(List.map,
         catFromDict,
         dictList);
         return A2(List.all,
         Maybe.isJust,
         jlist) ? Maybe.Just(A2(List.map,
         fromJust,
         jlist)) : Maybe.Nothing;
      }();
   };
   var Cats = function (a) {
      return {ctor: "Cats",_0: a};
   };
   var jsonToCats = function (jcat) {
      return function () {
         switch (jcat.ctor)
         {case "Just":
            switch (jcat._0.ctor)
              {case "Object":
                 return function () {
                      var _v14 = A2(Dict.get,
                      "cats",
                      jcat._0._0);
                      switch (_v14.ctor)
                      {case "Just":
                         switch (_v14._0.ctor)
                           {case "Array":
                              return function () {
                                   var _v17 = objlistToCatList(_v14._0._0);
                                   switch (_v17.ctor)
                                   {case "Just":
                                      return Maybe.Just(Cats({_: {}
                                                             ,cats: _v17._0}));
                                      case "Nothing":
                                      return Maybe.Nothing;}
                                   _E.Case($moduleName,
                                   "between lines 36 and 39");
                                }();}
                           break;}
                      return Maybe.Nothing;
                   }();}
              break;}
         return Maybe.Nothing;
      }();
   };
   _elm.Cat.values = {_op: _op
                     ,catFromDict: catFromDict
                     ,fromJust: fromJust
                     ,objlistToCatList: objlistToCatList
                     ,jsonToCats: jsonToCats
                     ,Cats: Cats
                     ,Cat: Cat};
   return _elm.Cat.values;
};</script></head><body><script type="text/javascript">Elm.fullscreen(Elm.Main)</script><noscript></noscript></body></html>