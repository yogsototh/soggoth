<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>Main</title><script type="text/javascript" src="/static/js/elm-runtime.js"></script><script type="text/javascript">Elm.Main = Elm.Main || {};
Elm.Main.make = function (_elm) {
   "use strict";
   _elm.Main = _elm.Main || {};
   if (_elm.Main.values)
   return _elm.Main.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _A = _N.Array.make(_elm),
   _E = _N.Error.make(_elm),
   $moduleName = "Main";
   var Array = Elm.Array.make(_elm);
   var Basics = Elm.Basics.make(_elm);
   var Cat = Elm.Cat.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Dict = Elm.Dict.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var Grid = Elm.Grid.make(_elm);
   var HSV = Elm.HSV.make(_elm);
   var Http = Elm.Http.make(_elm);
   var Json = Elm.Json.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Json = Elm.Native.Json.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var Window = Elm.Window.make(_elm);
   var _op = {};
   var jsonGetRequest = function (url) {
      return A4(Http.request,
      "GET",
      url,
      "",
      _L.fromArray([{ctor: "_Tuple2"
                    ,_0: "Accept"
                    ,_1: "application/json"}]));
   };
   var getJson = function (url) {
      return Http.send(Signal.constant(jsonGetRequest(url)));
   };
   var elapsedTime = A3(Signal.foldp,
   F2(function (x,y) {
      return x + y;
   }),
   0,
   Time.fps(30));
   var gonSize = 150;
   var rotationSpeed = 1 / 5000;
   var showOneCat = F2(function (t,
   _v0) {
      return function () {
         switch (_v0.ctor)
         {case "Cat":
            return function () {
                 var ccolor = function () {
                    var _v3 = _v0._0.age;
                    switch (_v3.ctor)
                    {case "Just": switch (_v3._0)
                         {case 0: return A4(Color.rgba,
                              255,
                              220,
                              220,
                              1.0);
                            case 1: return Color.red;
                            case 2: return Color.orange;
                            case 3: return Color.yellow;
                            case 4: return Color.green;
                            case 5: return Color.blue;}
                         return function () {
                            var hue = Basics.toFloat(_v3._0 * 36);
                            return A3(HSV.hsv,
                            hue,
                            0.5,
                            180.0);
                         }();
                       case "Nothing":
                       return Color.grey;}
                    _E.Case($moduleName,
                    "between lines 53 and 63");
                 }();
                 var shape = function () {
                    var _v5 = _v0._0.age;
                    switch (_v5.ctor)
                    {case "Just": switch (_v5._0)
                         {case 0:
                            return A2(Graphics.Collage.oval,
                              gonSize - 20,
                              gonSize);
                            case 1:
                            return A2(Graphics.Collage.oval,
                              gonSize - 20,
                              gonSize);
                            case 2:
                            return A2(Graphics.Collage.rect,
                              gonSize / 2,
                              gonSize);}
                         return A2(Graphics.Collage.ngon,
                         _v5._0,
                         gonSize / 2);
                       case "Nothing":
                       return A2(Graphics.Collage.oval,
                         gonSize - 10,
                         gonSize - 20);}
                    _E.Case($moduleName,
                    "between lines 47 and 53");
                 }();
                 return Graphics.Element.layers(_L.fromArray([A3(Graphics.Collage.collage,
                                                             Basics.round(gonSize),
                                                             Basics.round(gonSize),
                                                             _L.fromArray([Graphics.Collage.rotate(t * rotationSpeed)(A2(Graphics.Collage.move,
                                                             {ctor: "_Tuple2"
                                                             ,_0: 0
                                                             ,_1: 0},
                                                             A2(Graphics.Collage.filled,
                                                             ccolor,
                                                             shape)))]))
                                                             ,A4(Graphics.Element.container,
                                                             Basics.round(gonSize),
                                                             Basics.round(gonSize),
                                                             Graphics.Element.middle,
                                                             Text.centered(A2(Text.color,
                                                             A4(Color.rgba,
                                                             0,
                                                             0,
                                                             0,
                                                             0.6),
                                                             Text.bold(Text.toText(_v0._0.name)))))]));
              }();}
         _E.Case($moduleName,
         "between lines 47 and 66");
      }();
   });
   var showCats = F3(function (_v7,
   t,
   cats) {
      return function () {
         switch (_v7.ctor)
         {case "_Tuple2":
            return function () {
                 switch (cats.ctor)
                 {case "Just":
                    switch (cats._0.ctor)
                      {case "Cats":
                         return A3(Grid.reactiveGrid,
                           {ctor: "_Tuple2"
                           ,_0: 200
                           ,_1: 200},
                           A2(List.map,
                           showOneCat(t),
                           function (_) {
                              return _.cats;
                           }(cats._0._0)),
                           _v7._0);}
                      break;}
                 return A3(Graphics.Collage.collage,
                 _v7._0,
                 _v7._1,
                 _L.fromArray([A2(Graphics.Collage.rotate,
                 t * rotationSpeed,
                 A2(Graphics.Collage.filled,
                 Color.red,
                 A2(Graphics.Collage.ngon,
                 4,
                 50)))]));
              }();}
         _E.Case($moduleName,
         "between lines 40 and 42");
      }();
   });
   var display = F3(function (_v14,
   t,
   response) {
      return function () {
         switch (_v14.ctor)
         {case "_Tuple2":
            return function () {
                 switch (response.ctor)
                 {case "Failure":
                    return Text.asText(response);
                    case "Success":
                    return A2(showCats,
                      {ctor: "_Tuple2"
                      ,_0: _v14._0
                      ,_1: _v14._1},
                      t)(Cat.jsonToCats(Json.fromString(response._0)));
                    case "Waiting":
                    return A3(Graphics.Element.container,
                      _v14._0,
                      _v14._1,
                      Graphics.Element.middle)(Text.plainText("WAITING..."));}
                 _E.Case($moduleName,
                 "between lines 31 and 34");
              }();}
         _E.Case($moduleName,
         "between lines 31 and 34");
      }();
   });
   var main = A2(Signal._op["~"],
   A2(Signal._op["~"],
   A2(Signal._op["<~"],
   display,
   Window.dimensions),
   elapsedTime),
   getJson("/cats"));
   _elm.Main.values = {_op: _op
                      ,rotationSpeed: rotationSpeed
                      ,gonSize: gonSize
                      ,elapsedTime: elapsedTime
                      ,main: main
                      ,display: display
                      ,showCats: showCats
                      ,showOneCat: showOneCat
                      ,jsonGetRequest: jsonGetRequest
                      ,getJson: getJson};
   return _elm.Main.values;
};Elm.Cat = Elm.Cat || {};
Elm.Cat.make = function (_elm) {
   "use strict";
   _elm.Cat = _elm.Cat || {};
   if (_elm.Cat.values)
   return _elm.Cat.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _A = _N.Array.make(_elm),
   _E = _N.Error.make(_elm),
   $moduleName = "Cat";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Dict = Elm.Dict.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var Json = Elm.Json.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Json = Elm.Native.Json.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var _op = {};
   var fromJust = function (_v0) {
      return function () {
         switch (_v0.ctor)
         {case "Just": return _v0._0;}
         _E.Case($moduleName,
         "on line 22, column 21 to 22");
      }();
   };
   var Cat = function (a) {
      return {ctor: "Cat",_0: a};
   };
   var catFromDict = function (val) {
      return function () {
         switch (val.ctor)
         {case "Object":
            return function () {
                 var _v5 = A2(Dict.get,
                 "name",
                 val._0);
                 switch (_v5.ctor)
                 {case "Just":
                    switch (_v5._0.ctor)
                      {case "String":
                         return function () {
                              var _v8 = A2(Dict.get,
                              "age",
                              val._0);
                              switch (_v8.ctor)
                              {case "Just":
                                 switch (_v8._0.ctor)
                                   {case "Null":
                                      return Maybe.Just(Cat({_: {}
                                                            ,age: Maybe.Nothing
                                                            ,name: _v5._0._0}));
                                      case "Number":
                                      return Maybe.Just(Cat({_: {}
                                                            ,age: Maybe.Just(Basics.round(_v8._0._0))
                                                            ,name: _v5._0._0}));}
                                   break;}
                              return Maybe.Nothing;
                           }();}
                      break;}
                 return Maybe.Nothing;
              }();}
         return Maybe.Nothing;
      }();
   };
   var objlistToCatList = function (dictList) {
      return function () {
         var jlist = A2(List.map,
         catFromDict,
         dictList);
         return A2(List.all,
         Maybe.isJust,
         jlist) ? Maybe.Just(A2(List.map,
         fromJust,
         jlist)) : Maybe.Nothing;
      }();
   };
   var Cats = function (a) {
      return {ctor: "Cats",_0: a};
   };
   var jsonToCats = function (jcat) {
      return function () {
         switch (jcat.ctor)
         {case "Just":
            switch (jcat._0.ctor)
              {case "Object":
                 return function () {
                      var _v14 = A2(Dict.get,
                      "cats",
                      jcat._0._0);
                      switch (_v14.ctor)
                      {case "Just":
                         switch (_v14._0.ctor)
                           {case "Array":
                              return function () {
                                   var _v17 = objlistToCatList(_v14._0._0);
                                   switch (_v17.ctor)
                                   {case "Just":
                                      return Maybe.Just(Cats({_: {}
                                                             ,cats: _v17._0}));
                                      case "Nothing":
                                      return Maybe.Nothing;}
                                   _E.Case($moduleName,
                                   "between lines 36 and 39");
                                }();}
                           break;}
                      return Maybe.Nothing;
                   }();}
              break;}
         return Maybe.Nothing;
      }();
   };
   _elm.Cat.values = {_op: _op
                     ,catFromDict: catFromDict
                     ,fromJust: fromJust
                     ,objlistToCatList: objlistToCatList
                     ,jsonToCats: jsonToCats
                     ,Cats: Cats
                     ,Cat: Cat};
   return _elm.Cat.values;
};Elm.Grid = Elm.Grid || {};
Elm.Grid.make = function (_elm) {
   "use strict";
   _elm.Grid = _elm.Grid || {};
   if (_elm.Grid.values)
   return _elm.Grid.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _A = _N.Array.make(_elm),
   _E = _N.Error.make(_elm),
   $moduleName = "Grid";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Json = Elm.Native.Json.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var _op = {};
   var groupBy = F2(function (n,
   l) {
      return function () {
         switch (l.ctor)
         {case "[]":
            return _L.fromArray([]);}
         return {ctor: "::"
                ,_0: A2(List.take,n,l)
                ,_1: A2(groupBy,
                n,
                A2(List.drop,n,l))};
      }();
   });
   var reactiveGrid = F3(function (_v1,
   elements,
   w) {
      return function () {
         switch (_v1.ctor)
         {case "_Tuple2":
            return function () {
                 var box = A3(Graphics.Element.container,
                 _v1._0,
                 _v1._1,
                 Graphics.Element.middle);
                 var drawOneLine = function (oneLine) {
                    return Graphics.Element.flow(Graphics.Element.right)(A2(List.map,
                    box,
                    oneLine));
                 };
                 var nbOnRow = A2(Basics.div,
                 w,
                 _v1._0);
                 var grid = A2(groupBy,
                 nbOnRow,
                 elements);
                 var nbLines = List.length(grid);
                 return A3(Graphics.Element.container,
                 w,
                 _v1._1 * nbLines,
                 Graphics.Element.midTop)(Graphics.Element.flow(Graphics.Element.down)(A2(List.map,
                 drawOneLine,
                 grid)));
              }();}
         _E.Case($moduleName,
         "between lines 10 and 18");
      }();
   });
   _elm.Grid.values = {_op: _op
                      ,reactiveGrid: reactiveGrid
                      ,groupBy: groupBy};
   return _elm.Grid.values;
};Elm.HSV = Elm.HSV || {};
Elm.HSV.make = function (_elm) {
   "use strict";
   _elm.HSV = _elm.HSV || {};
   if (_elm.HSV.values)
   return _elm.HSV.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _A = _N.Array.make(_elm),
   _E = _N.Error.make(_elm),
   $moduleName = "HSV";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Json = Elm.Native.Json.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var _op = {};
   var hsv = F3(function (h,s,v) {
      return function () {
         var vi = Basics.floor(v);
         var p = Basics.floor(v * (1 - s));
         var hint = Basics.floor(h / 60);
         var hi = A2(Basics.mod,hint,6);
         var f = h / 60 - Basics.toFloat(hint);
         var q = Basics.floor(v * (1 - f * s));
         var t = Basics.floor(v * (1 - (1 - f) * s));
         return function () {
            switch (hi)
            {case 0: return A3(Color.rgb,
                 vi,
                 t,
                 p);
               case 1: return A3(Color.rgb,
                 q,
                 vi,
                 p);
               case 2: return A3(Color.rgb,
                 p,
                 vi,
                 t);
               case 3: return A3(Color.rgb,
                 p,
                 q,
                 vi);
               case 4: return A3(Color.rgb,
                 t,
                 p,
                 vi);
               case 5: return A3(Color.rgb,
                 vi,
                 p,
                 q);}
            _E.Case($moduleName,
            "between lines 14 and 20");
         }();
      }();
   });
   _elm.HSV.values = {_op: _op
                     ,hsv: hsv};
   return _elm.HSV.values;
};</script></head><body><script type="text/javascript">Elm.fullscreen(Elm.Main)</script><noscript></noscript></body></html>